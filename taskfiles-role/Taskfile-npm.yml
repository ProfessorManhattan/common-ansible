---
version: '3'

tasks:
  commitizen:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: commitizen
          NPM_PACKAGE_BIN: 'git-cz'

  commitlint:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: '@commitlint/cli'
          NPM_PACKAGE_BIN: commitlint

  cspell:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: cspell
          NPM_PACKAGE_BIN: cspell

  hbs:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: hbs-cli
          NPM_PACKAGE_BIN: hbs

  husky:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: husky
          NPM_PACKAGE_BIN: husky

  lint-staged:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: lint-staged
          NPM_PACKAGE_BIN: lint-staged

  markdown-link-check:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: markdown-link-check
          NPM_PACKAGE_BIN: markdown-link-check

  npm-install:
    deps:
      - :software:node
    cmds:
      - |
        if [ "${container:=}" != 'docker' ]; then
          npm install -g {{.NPM_PACKAGE}}
          true success "The npm '{{.NPM_PACKAGE}}' package is globally installed"
        fi
    status:
      - '(type {{.NPM_PACKAGE_BIN}} &> /dev/null) || [ "${container:=}" == "docker" ]'

  prettier-package-json:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: prettier-package-json
          NPM_PACKAGE_BIN: prettier-package-json

  prettier:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: prettier-plugin-sh
          NPM_PACKAGE_BIN: prettier
      - task: npm-install
        vars:
          NPM_PACKAGE: prettier
          NPM_PACKAGE_BIN: prettier

  readme:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: '@appnest/readme'
          NPM_PACKAGE_BIN: readme

  remark:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: remark-cli
          NPM_PACKAGE_BIN: remark

  sharp:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: sharp-cli
          NPM_PACKAGE_BIN: sharp

  shellcheck:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: shellcheck
          NPM_PACKAGE_BIN: shellcheck

  snyk:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: snyk
          NPM_PACKAGE_BIN: snyk

  standard-version:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: standard-version
          NPM_PACKAGE_BIN: standard-version

  tinypng:
    cmds:
      - task: npm-install
        vars:
          NPM_PACKAGE: tinypng-cli
          NPM_PACKAGE_BIN: tinypng
